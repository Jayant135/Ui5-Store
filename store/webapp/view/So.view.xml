<mvc:View
    controllerName="store.controller.So"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core">

    <Page title="Sales Orders">

        <!-- PREVIOUS SOs -->
        <Panel headerText="Previous Sales Orders" class="sapUiSmallMargin">
            <Table
                items="{so>/soList}"
                inset="false"
                alternateRowColors="true">

                <columns>
                    <Column><Text text="SO No"/></Column>
                    <Column><Text text="Date"/></Column>
                    <Column><Text text="Customer"/></Column>
                    <Column hAlign="End"><Text text="Amount"/></Column>
                </columns>

                <items>
                    <ColumnListItem type="Active" press="onSORowPress">
                        <cells>
                            <Text text="{so>soNumber}"/>
                            <Text text="{so>soDate}"/>
                            <Text text="{so>customer}"/>
                            <ObjectNumber number="{so>totalAmount}" unit="₹"/>
                        </cells>
                    </ColumnListItem>
                </items>

            </Table>
        </Panel>

        <!-- ACTION BAR -->
        <OverflowToolbar class="sapUiSmallMargin">
            <ToolbarSpacer/>
            <Button
                icon="sap-icon://add"
                text="Create SO"
                type="Emphasized"
                press="onCreateSO"/>
        </OverflowToolbar>

        <!-- CREATE SO DIALOG -->
        <Dialog
            id="soDialog"
            title="Create Sales Order"
            contentWidth="700px"
            draggable="true">

            <VBox class="sapUiMediumMargin">

                <Label text="Customer Name"/>
                <Input value="{so>/currentSO/customer}"/>

                <Label text="Category"/>
                <Select items="{so>/categories}" change="onCategoryChange">
                    <items>
                        <core:Item key="{so>}" text="{so>}"/>
                    </items>
                </Select>

                <Label text="Item"/>
                <ComboBox
                    id="soItemSelect"
                    items="{so>/items}"
                    selectionChange="onItemSelect">
                    <items>
                        <core:Item key="{so>id}" text="{so>name}"/>
                    </items>
                </ComboBox>

                <Label text="Quantity"/>
                <Input id="soQtyInput" type="Number"/>

                <Button
                    text="Add Item"
                    icon="sap-icon://add"
                    press="onAddItem"/>

                <!-- ITEMS TABLE -->
                <Table items="{so>/currentSO/items}" class="sapUiSmallMarginTop">
                    <columns>
                        <Column><Text text="Item"/></Column>
                        <Column><Text text="Qty"/></Column>
                        <Column><Text text="Price"/></Column>
                        <Column hAlign="End"><Text text="Total"/></Column>
                    </columns>

                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text text="{so>name}"/>
                                <Text text="{so>qty}"/>
                                <Text text="{so>price}"/>
                                <ObjectNumber number="{so>total}" unit="₹"/>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>

            </VBox>

            <beginButton>
                <Button text="Save SO" type="Emphasized" press="onSaveSO"/>
            </beginButton>
            <endButton>
                <Button text="Cancel" press="onCancelSO"/>
            </endButton>

        </Dialog>

    </Page>
</mvc:View>
